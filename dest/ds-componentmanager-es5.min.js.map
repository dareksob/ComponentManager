{"version":3,"sources":["ds-componentmanager-es5.min.js"],"names":["ComponentManager","this","path","detectAttr","settingAttr","splitSeperator","observers","$traceurRuntime","setup","setting","$__2","keys","Object","forEach","property","on","eventName","callback","push","trigger","payload","getComponentNodes","root","querySelectorAll","getNodesOfComponent","componentName","arguments","document","nodes","match","RegExp","Array","prototype","filter","call","node","test","getAttribute","detect","Promise","resolve","reject","index","length","$__3","components","split","settings","hasAttribute","JSON","parse","name","hasOwnProperty","$__default","defineProperties","module","exports","default","get","__esModule","value"],"mappings":"AAAA,YACA,IAAIA,kBAAmB,WACrB,QAASA,KACPC,KAAKC,KAAO,cACZD,KAAKE,WAAa,kBAClBF,KAAKG,YAAc,gBACnBH,KAAKI,eAAiB,IACtBJ,KAAKK,aAEP,MAAQC,iBAA2B,YAAEP,GACnCQ,MAAO,SAASC,GACd,GAAIC,GAAOT,KACPU,EAAOC,OAAOD,KAAKF,EAMvB,OALAE,GAAKE,QAAQ,SAASC,GACU,gBAAnBJ,GAAKI,KACdJ,EAAKI,GAAYL,EAAQK,MAGtBb,MAETc,GAAI,SAASC,EAAWC,GAKtB,MAJKhB,MAAKK,UAAUU,KAClBf,KAAKK,UAAUU,OAEjBf,KAAKK,UAAUU,GAAWE,KAAKD,GACxBhB,MAETkB,QAAS,SAASH,EAAWI,GAM3B,MALInB,MAAKK,UAAUU,IACjBf,KAAKK,UAAUU,GAAWH,QAAQ,SAASI,GACzCA,EAASG,KAGNnB,MAEToB,kBAAmB,SAASC,GAC1B,MAAOA,GAAKC,iBAAkB,IAAMtB,KAAKE,WAAa,MAExDqB,oBAAqB,SAASC,GAC5B,GAAIH,GAAwB,SAAjBI,UAAU,GAAkBA,UAAU,GAAKC,SAClDjB,EAAOT,KACP2B,EAAQ3B,KAAKoB,kBAAkBC,GAC/BO,EAAQ,GAAIC,QAAQ,IAAML,EAAgB,MAAQA,EAAgB,KAAOA,EAI7E,OAHAG,GAAQG,MAAMC,UAAUC,OAAOC,KAAKN,EAAO,SAASO,GAClD,MAAON,GAAMO,KAAKD,EAAKE,aAAa3B,EAAKP,gBAI7CmC,OAAQ,SAAShB,GACf,GAAIZ,GAAOT,IACX,OAAO,IAAIsC,SAAQ,SAASC,EAASC,GAqBnC,IApBA,GAAIb,GAAQlB,EAAKW,kBAAkBC,GAC/BoB,EAAQd,EAAMe,OACdC,EAAO,WACT,GAAIT,GAAOP,EAAMc,GACbG,EAAaV,EAAKE,aAAa3B,EAAKP,YAAY2C,MAAMpC,EAAKL,gBAC3D0C,IACAZ,GAAKa,aAAatC,EAAKN,eACzB2C,EAAWE,KAAKC,MAAMf,EAAKE,aAAa3B,EAAKN,eAE/CyC,EAAWhC,QAAQ,SAASsC,GAC1B,GAAI1C,GAAUsC,GAAYA,EAASK,eAAeD,GAAQJ,EAASI,MAC/DjD,EAAQ,GAAKQ,EAAKR,KAAOiD,CAC7BzC,GAAKS,QAAQ,gBACXgB,KAAMA,EACNgB,KAAMA,EACNjD,KAAMA,EACNO,QAASA,OAIRiC,KACLE,GAEFJ,GAAQZ,cAKZyB,WAAarD,gBACjBY,QAAO0C,iBAAiBC,OAAOC,SAC7BC,WAAUC,IAAK,WACX,MAAOL,cAEXM,YAAaC,OAAO","file":"ds-componentmanager-es5.min.js","sourcesContent":["\"use strict\";\nvar ComponentManager = function() {\n  function ComponentManager() {\n    this.path = 'components/';\n    this.detectAttr = 'data-components';\n    this.settingAttr = 'data-settings';\n    this.splitSeperator = ',';\n    this.observers = {};\n  }\n  return ($traceurRuntime.createClass)(ComponentManager, {\n    setup: function(setting) {\n      var $__2 = this;\n      var keys = Object.keys(setting);\n      keys.forEach(function(property) {\n        if (typeof $__2[property] === 'string') {\n          $__2[property] = setting[property];\n        }\n      });\n      return this;\n    },\n    on: function(eventName, callback) {\n      if (!this.observers[eventName]) {\n        this.observers[eventName] = [];\n      }\n      this.observers[eventName].push(callback);\n      return this;\n    },\n    trigger: function(eventName, payload) {\n      if (this.observers[eventName]) {\n        this.observers[eventName].forEach(function(callback) {\n          callback(payload);\n        });\n      }\n      return this;\n    },\n    getComponentNodes: function(root) {\n      return root.querySelectorAll((\"[\" + this.detectAttr + \"]\"));\n    },\n    getNodesOfComponent: function(componentName) {\n      var root = arguments[1] !== (void 0) ? arguments[1] : document;\n      var $__2 = this;\n      var nodes = this.getComponentNodes(root);\n      var match = new RegExp((\"^\" + componentName + \",|^\" + componentName + \"|,\" + componentName));\n      nodes = Array.prototype.filter.call(nodes, function(node) {\n        return match.test(node.getAttribute($__2.detectAttr));\n      });\n      return nodes;\n    },\n    detect: function(root) {\n      var $__2 = this;\n      return new Promise(function(resolve, reject) {\n        var nodes = $__2.getComponentNodes(root);\n        var index = nodes.length;\n        var $__3 = function() {\n          var node = nodes[index];\n          var components = node.getAttribute($__2.detectAttr).split($__2.splitSeperator);\n          var settings = {};\n          if (node.hasAttribute($__2.settingAttr)) {\n            settings = JSON.parse(node.getAttribute($__2.settingAttr));\n          }\n          components.forEach(function(name) {\n            var setting = settings && settings.hasOwnProperty(name) ? settings[name] : {};\n            var path = (\"\" + $__2.path + name);\n            $__2.trigger('AddComponent', {\n              node: node,\n              name: name,\n              path: path,\n              setting: setting\n            });\n          });\n        };\n        while (index--) {\n          $__3();\n        }\n        resolve(nodes);\n      });\n    }\n  }, {});\n}();\nvar $__default = ComponentManager;\nObject.defineProperties(module.exports, {\n  default: {get: function() {\n      return $__default;\n    }},\n  __esModule: {value: true}\n});\n"],"sourceRoot":"/source/"}